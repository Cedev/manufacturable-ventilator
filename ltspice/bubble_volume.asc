Version 4
SHEET 1 2232 852
WIRE 1216 -304 1200 -304
WIRE 1376 -304 1344 -304
WIRE 1216 -272 1200 -272
WIRE 1216 -240 1200 -240
WIRE 1280 -144 1280 -176
WIRE 848 -96 848 -128
WIRE 192 -80 176 -80
WIRE 1280 -32 1280 -64
WIRE 192 32 176 32
WIRE 352 32 320 32
WIRE 848 32 848 -16
WIRE 192 64 176 64
WIRE 192 96 176 96
WIRE 432 96 384 96
WIRE 496 128 400 128
WIRE 432 160 400 160
WIRE 256 208 256 160
WIRE 288 208 256 208
WIRE 256 272 256 208
WIRE 256 400 256 352
WIRE 1024 496 1008 496
WIRE 1216 496 1152 496
WIRE 1024 528 1008 528
WIRE 1024 560 1008 560
WIRE 1328 592 1232 592
WIRE 1088 624 832 624
WIRE 1328 704 1328 672
FLAG 288 208 r
IOPIN 288 208 Out
FLAG 496 128 theta
IOPIN 496 128 Out
FLAG 176 -80 area
IOPIN 176 -80 In
FLAG 432 96 arc
IOPIN 432 96 Out
FLAG 352 32 bubble_area
FLAG 432 160 x
IOPIN 432 160 Out
FLAG 176 32 beta
IOPIN 176 32 In
FLAG 176 64 step
IOPIN 176 64 In
FLAG 1008 528 step
IOPIN 1008 528 In
FLAG 176 96 alph
IOPIN 176 96 In
FLAG 1008 560 alph
IOPIN 1008 560 In
FLAG 1008 496 beta
IOPIN 1008 496 In
FLAG 1328 704 0
FLAG 1216 496 min_area
FLAG 832 624 min_radius
FLAG 256 400 0
FLAG 848 -128 target_area
FLAG 848 32 0
FLAG 1376 -304 max_area
FLAG 1200 -304 beta
IOPIN 1200 -304 In
FLAG 1200 -272 step
IOPIN 1200 -272 In
FLAG 1200 -240 alph
IOPIN 1200 -240 In
FLAG 1280 -32 0
SYMBOL nc 192 -80 R0
SYMATTR InstName X3
SYMBOL bubble_volume_theta 1120 560 R0
SYMATTR InstName Xmin_area
SYMBOL bv 1328 576 R0
SYMATTR InstName Bpi
SYMATTR Value V=pi
SYMBOL bubble_volume_r 288 96 R0
SYMATTR InstName Xbubble_area
SYMBOL bi 256 352 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -1137 12 Left 2
SYMATTR InstName Br
SYMATTR Value I=v(r)+if(v(r) > v(min_radius), v(bubble_area)-v(target_area), v(r)+v(min_area)-v(target_area)-v(min_radius))
SYMATTR SpiceLine rpar=1
SYMBOL bi 848 -16 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -542 -46 Left 2
SYMATTR InstName Btarget_area
SYMATTR Value I=limit(v(area), v(min_area), v(max_area))
SYMATTR SpiceLine rpar=1
SYMBOL bubble_volume_r 1312 -240 R0
SYMATTR InstName Xmax_area
SYMBOL voltage 1280 -160 R0
SYMATTR InstName Vr_max
SYMATTR Value {r_max}
TEXT -144 -216 Left 2 !.param r_max=1e20
